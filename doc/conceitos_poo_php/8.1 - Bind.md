# BIND

## O que Ã© o Bind?

Bind (vinculaÃ§Ã£o) Ã© o ato de associar uma abstraÃ§Ã£o a uma implementaÃ§Ã£o concreta em um contexto de resoluÃ§Ã£o de depedÃªncias. 

Formalmente:

- Binda Ã© uma regra declarativa que diz ao sistema:
- Quando alguÃ©m pedir X, forneÃ§a Y

Importante: 
- Bind nÃ£o cria objetos,
- Bind nÃ£o injeta objetos,
- Bind apenas declara um mapeamento

## Onde o bind existe conceitualmente

O bind existe exclusivamente em um IoC Container ou mecanismo equivalente. 

Ele nÃ£o pertence: 

- Ã€ classe de domÃ­nio
- Ã€ classe de serviÃ§o 
- Ã€ regra de negÃ³cio

Ele pertence Ã  infraestrutura. 

## O problema que o bind resolve

Sem bind: 

```php
class PedidoService
{
    public function __construct(
        // perceba que estamos fazendo a associacao/agregacao de uma class concreta
        private PedidoRepositoryMysql $repo
    ) {}
}
```
âŒ DependÃªncia concreta
âŒ Viola DIP
âŒ Baixa flexibilidade

Com bind

```php
class PedidoService
{
    public function __construct(
        # aplicando uma interface que com bind... acessa uma class concreta!
        # muito usado no laravel
        private PedidoRepositoryInterface $repo
    ) {}
}
```

Mas agora surge a pergunta:

    Qual implementaÃ§Ã£o o sistema deve usar?

ğŸ‘‰ Resposta: bind

## Bind na forma mais pura (Sem FrameWork)

```php
$container->bind(
    PedidoRepositoryInterface::class, # pediu a interface
    PedidoRepositoryMysql::class  # entrege a class concreta com os metodos definidos na interface

    /*
        OBSERVAÃ‡ÃƒO IMPORTANTE! QUANDO USAMOS ISSO:

            PedidoRepositoryMySql::class

        Estamos obtendo uma string contendo o nome completo daquela classe,
        Incluindo o Namespace. FQN - FULLY QUALIFIED NAME

        FQN -> Basicamente Ã© o endereÃ§o completo de uma classe dentro do seu projeto

        Imageni que sua classe estÃ¡ em App\Repositories\PedidoRepositoryMysql.

        Ao Escrever PedidoRepositoryMysql::class, O PHP substitui isso exatamente por:
        "App\Repositories\PedidoRepositoryMysql"

        O conceito tambÃ©m se aplica a interfaces... Visto que estamos obtendo o FQN
    
    */
);
```

SemÃ¢ntica disso:

    â€œSempre que alguÃ©m pedir PedidoRepositoryInterface,
    entregue PedidoRepositoryMysql.â€


## Bind NÃƒO Ã© injeÃ§Ã£o de dependÃªncia

| Conceito      | O que faz      |
| ------------- | -------------- |
| Bind          | Define regra   |
| DI            | Aplica a regra |
| IoC Container | Executa tudo   |

O bind nÃ£o injeta nada, ele prepara o terreno

## TIPOS DE BIND

### Bind para classe concreta

```php
$container->bind(A::class,B::class)
```

- Simples
- Mais comum

### Bind para fÃ¡brica (closure)

```php
$container->bind(LoggerInterface::class,function(){
    return new FileLogger('/logs/app.log')
})
```

- LÃ³gica Customizada
- ConfiguraÃ§Ã£o externa
- DependÃªncias internas

## Bind singleton

```php
$container->singleton(Config::class, function () {
    return new Config($_ENV);
});
```

- Uma instÃ¢ncia 
- Controlado pelo container

## Bind contextual

```php
$container->when(RelatorioService::class)
          ->needs(LoggerInterface::class)
          ->give(FileLogger::class);
```

âœ” ImplementaÃ§Ãµes diferentes conforme o contexto

## Bind e ciclo de vida

O bind nÃ£o define apenas o â€œo quÃªâ€, mas tambÃ©m o â€œcomo e quandoâ€.

| Tipo      | Ciclo                           |
| --------- | ------------------------------- |
| bind      | Nova instÃ¢ncia a cada resoluÃ§Ã£o |
| singleton | InstÃ¢ncia Ãºnica                 |
| scoped    | Uma por requisiÃ§Ã£o              |

## Bind vs Factory (diferenÃ§a conceitual)

| Factory           | Bind                     |
| ----------------- | ------------------------ |
| CÃ³digo imperativo | ConfiguraÃ§Ã£o declarativa |
| Local             | Global                   |
| Classe decide     | Infraestrutura decide    |

Bind substitui muitas factories manuais 

## Onde o bind deve ficar?

ğŸ“Œ Regra de ouro arquitetural

    Bind pertence Ã  borda do sistema.

Em PHP:

- Bootstrap

- Service Provider

- MÃ³dulo de infraestrutura

âŒ Nunca no domÃ­nio
âŒ Nunca em entidades
âŒ Nunca em serviÃ§os de negÃ³cio

## Exemplo completo (fluxo real)

```php

// Definicao da abastracao
interface PedidoRepositoryInterface
{
    public function salvar(Pedido $pedido): void;
}

// Implementacao concreta
class PedidoRepositoryMysql implements PedidoRepositoryInterface
{
    public function salvar(Pedido $pedido): void {}
}

// Bind no container
$container->bind(
    PedidoRepositoryInterface::class,
    PedidoRepositoryMysql::class
);

// Uso no ServiÃ§o
class PedidoService
{
    public function __construct(
        private PedidoRepositoryInterface $repo
    ) {}
}

```

ğŸ“Œ O serviÃ§o nÃ£o sabe quem implementa
ğŸ“Œ O bind resolve isso externamente

## Erros comuns com bind

âŒ Bind espalhado pelo sistema

    Indica arquitetura fraca.

âŒ Bind em domÃ­nio

    Mistura infraestrutura com negÃ³cio.

âŒ Bind sem abstraÃ§Ã£o

```php
    bind(Logger::class,Logger::class);
```

    DesnecessÃ¡rio


## Regra mental definitiva

Bind Ã© uma decisÃ£o de arquitetura, nÃ£o de cÃ³digo.

## Frase Final para Internalizar

- InjeÃ§Ã£o entrega.
- Bind decide.
- Container orquestra.